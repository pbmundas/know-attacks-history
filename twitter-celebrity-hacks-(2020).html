<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twitter Celebrity Hacks (2020) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "Twitter (2020)": {
                "name": "Twitter Celebrity Hacks (2020) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1566.003",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Spear-phishing via phone (vishing) to trick Twitter employees into providing credentials",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Lack of robust employee authentication" },
                            { "name": "Assets", "value": "Employee credentials, internal systems" },
                            { "name": "IOCs", "value": "Anomalous login attempts from external IPs" },
                            { "name": "Threat Actors", "value": "Graham Ivan Clark, Mason Sheppard, Nima Fazeli, Joseph James O’Connor" },
                            { "name": "Parameters", "value": "Authentication logs, vishing call monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1059",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed commands via Twitter’s internal administrative tools to take over accounts",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Twitter administrative tools" },
                            { "name": "IOCs", "value": "Unauthorized use of admin tools" },
                            { "name": "Parameters", "value": "Admin tool access logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1078",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Gained access to privileged internal tools using stolen employee credentials",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Twitter internal systems" },
                            { "name": "IOCs", "value": "Anomalous admin tool access" },
                            { "name": "Parameters", "value": "Privilege escalation monitoring, access logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1005",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Collected Twitter account data, including direct messages and user information",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Twitter accounts, direct messages" },
                            { "name": "IOCs", "value": "Unauthorized data access from admin tools" },
                            { "name": "Parameters", "value": "Data access logs, DLP monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.001",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "Used HTTPS-based communication to manage compromised accounts via internal tools",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Compromised Twitter accounts" },
                            { "name": "IOCs", "value": "HTTPS traffic to attacker-controlled domains" },
                            { "name": "Parameters", "value": "Network traffic analysis, DNS queries" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Downloaded Twitter data from 7 accounts and accessed 36 direct message inboxes",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Twitter account data, direct messages" },
                            { "name": "IOCs", "value": "Unauthorized data downloads" },
                            { "name": "Parameters", "value": "Network egress filtering, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1485",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Manipulated account content to post fraudulent Bitcoin scam tweets",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Twitter accounts, public posts" },
                            { "name": "IOCs", "value": "Fraudulent Bitcoin scam tweets" },
                            { "name": "Parameters", "value": "Content monitoring, social media analytics" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "Twitter (2020)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "privilege-escalation", "collection",
                    "command-and-control", "exfiltration", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                // Custom manual edges to ensure full connectivity
                const initialAccessNode = mitreData.techniques.findIndex(t => t.tactic === "initial-access") + 1;
                const executionNode = mitreData.techniques.findIndex(t => t.tactic === "execution") + 1;
                const privilegeEscalationNode = mitreData.techniques.findIndex(t => t.tactic === "privilege-escalation") + 1;
                const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;
                const commandAndControlNode = mitreData.techniques.findIndex(t => t.tactic === "command-and-control") + 1;
                const exfiltrationNode = mitreData.techniques.findIndex(t => t.tactic === "exfiltration") + 1;
                const impactNode = mitreData.techniques.findIndex(t => t.tactic === "impact") + 1;

                // Initial Access → Execution
                if (initialAccessNode > 0 && executionNode > 0) {
                    edges.push({ from: initialAccessNode, to: executionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Execution → Privilege Escalation
                if (executionNode > 0 && privilegeEscalationNode > 0) {
                    edges.push({ from: executionNode, to: privilegeEscalationNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Privilege Escalation → Collection
                if (privilegeEscalationNode > 0 && collectionNode > 0) {
                    edges.push({ from: privilegeEscalationNode, to: collectionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Collection → Command and Control
                if (collectionNode > 0 && commandAndControlNode > 0) {
                    edges.push({ from: collectionNode, to: commandAndControlNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Command and Control → Exfiltration
                if (commandAndControlNode > 0 && exfiltrationNode > 0) {
                    edges.push({ from: commandAndControlNode, to: exfiltrationNode, arrows: "to", color: { color: "green" }, width: 2 });
                }

                // Exfiltration → Impact
                if (exfiltrationNode > 0 && impactNode > 0) {
                    edges.push({ from: exfiltrationNode, to: impactNode, arrows: "to", color: { color: "purple" }, width: 2 });
                }

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
                    physics: { enabled: true },
                    nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
                    edges: { arrows: 'to', smooth: false },
                    interaction: { dragNodes: true, dragView: true, zoomView: true }
                };
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                network.fit();

                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
                    <a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">Twitter Celebrity Hacks (2020) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
                            <br/><strong>Background:</strong><br/>
                            <p>The Twitter celebrity hacks on July 15, 2020, compromised 130 high-profile accounts, including Barack Obama, Joe Biden, Elon Musk, Bill Gates, Kanye West, Kim Kardashian West, Jeff Bezos, Apple, and Uber. Led by 17-year-old Graham Ivan Clark, with Mason Sheppard, Nima Fazeli, and Joseph James O’Connor, the attackers used phone-based spear-phishing (vishing) to obtain employee credentials, accessing Twitter’s internal administrative tools. They tweeted from 45 accounts, accessed 36 direct message inboxes, and downloaded data from 7, promoting a Bitcoin scam that netted over $118,000. Twitter locked verified accounts, temporarily halting their tweets, and the FBI arrested the perpetrators by July 31, 2020, using Bitcoin transaction analysis. The attack exposed vulnerabilities in Twitter’s internal security and social engineering risks.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
        <div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

  <!-- Attack Timeline -->
  <section>
        <h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Date/Time</th>
                        <th class="py-2 px-4 border-b">Action</th>
                        <th class="py-2 px-4 border-b">Actor/Details</th>
                        <th class="py-2 px-4 border-b">Evidence/Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Pre-July 15, 2020</td>
                        <td class="py-2 px-4 border-b">Preparation: Hackers obtain Twitter employee credentials via phone-based spear-phishing (vishing).</td>
                        <td class="py-2 px-4 border-b">Graham Ivan Clark (17), Mason Sheppard (19), Nima Fazeli (22)</td>
                        <td class="py-2 px-4 border-b">Tricked employees into sharing VPN credentials; accessed internal admin tools.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 15, 2020, ~12:00 PM ET</td>
                        <td class="py-2 px-4 border-b">Breach activation: Hackers use admin tools to hijack 130 high-profile accounts.</td>
                        <td class="py-2 px-4 border-b">Clark, Sheppard, Fazeli</td>
                        <td class="py-2 px-4 border-b">Took over accounts of Obama, Biden, Musk, Gates, Kardashian, Bezos; posted Bitcoin scam tweets.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 15, 2020, ~2:00 PM ET</td>
                        <td class="py-2 px-4 border-b">Data access: Hackers download data from 7 accounts, access DMs in 36 accounts.</td>
                        <td class="py-2 px-4 border-b">Clark, Sheppard, Fazeli</td>
                        <td class="py-2 px-4 border-b">Private DMs and internal data exfiltrated; scam netted $120K in Bitcoin.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 15, 2020, ~3:00 PM ET</td>
                        <td class="py-2 px-4 border-b">Containment: Twitter locks verified accounts, disables tweet functionality, limits admin tool access.</td>
                        <td class="py-2 px-4 border-b">Twitter</td>
                        <td class="py-2 px-4 border-b">Breach contained; public backlash, stock dip.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 15–16, 2020</td>
                        <td class="py-2 px-4 border-b">Investigation: Twitter engages internal teams, notifies FBI.</td>
                        <td class="py-2 px-4 border-b">Twitter/FBI</td>
                        <td class="py-2 px-4 border-b">Confirms vishing attack; no further account takeovers.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 31, 2020</td>
                        <td class="py-2 px-4 border-b">Arrests: Clark, Sheppard, Fazeli arrested by FBI.</td>
                        <td class="py-2 px-4 border-b">FBI</td>
                        <td class="py-2 px-4 border-b">Clark charged with conspiracy, wire fraud; Sheppard extradited from UK.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">August 2020</td>
                        <td class="py-2 px-4 border-b">Legal proceedings: Clark pleads guilty; sentenced to 3 years.</td>
                        <td class="py-2 px-4 border-b">U.S. DOJ</td>
                        <td class="py-2 px-4 border-b">Youngest convicted hacker; restitution ordered.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">March 2021</td>
                        <td class="py-2 px-4 border-b">Fazeli sentenced: 3 years probation, 5 years supervised release.</td>
                        <td class="py-2 px-4 border-b">U.S. DOJ</td>
                        <td class="py-2 px-4 border-b">For conspiracy, unauthorized access; no prison time.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 2021</td>
                        <td class="py-2 px-4 border-b">Sheppard sentenced: 12 months home detention.</td>
                        <td class="py-2 px-4 border-b">U.S. DOJ</td>
                        <td class="py-2 px-4 border-b">For conspiracy; minimal sentence due to cooperation.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Dwell Time Analysis -->
        <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
        <p class="mb-4">Dwell time was approximately hours (July 15, 2020, ~12:00–3:00 PM ET), from initial hijacking to containment, due to rapid execution but swift response.</p>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Step 1: Initial Access (Pre-Jul 15)</th>
                        <th class="py-2 px-4 border-b">Step 2: Execution/Spread (Jul 15, ~12:00 PM)</th>
                        <th class="py-2 px-4 border-b">Step 3: Collection/Exfiltration (Jul 15, ~2:00 PM)</th>
                        <th class="py-2 px-4 border-b">Step 4: Containment (Jul 15, ~3:00 PM)</th>
                        <th class="py-2 px-4 border-b">Step 5: Legal/Recovery (Jul 31–2021)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Vishing compromised employee credentials. <br><strong>What went wrong</strong>: No 2FA, weak vishing training.</td>
                        <td class="py-2 px-4 border-b">Hijacked 130 accounts via admin tools. <br><strong>Factor</strong>: No segmentation, no IDS.</td>
                        <td class="py-2 px-4 border-b">Downloaded data from 7 accounts, accessed 36 DMs. <br><strong>Factor</strong>: No DLP or anomaly detection.</td>
                        <td class="py-2 px-4 border-b">Locked accounts, disabled tweet function. <br><strong>Factor</strong>: Rapid response, no initial SIEM.</td>
                        <td class="py-2 px-4 border-b">Arrests, sentences; enhanced security. <br><strong>Total time</strong>: $120K stolen, reputation damage.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time (~3 hours vs. 2020 median ~95 days) was ultra-short due to rapid execution, but the attack’s impact was amplified by high-profile targets and Bitcoin scam. Weak vishing defenses and no 2FA enabled quick access; swift containment prevented further damage.</p>

        <!-- Learnings -->
        <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                        <th class="py-2 px-4 border-b">Impact Assessment</th>
                        <th class="py-2 px-4 border-b">Detection Opportunities</th>
                        <th class="py-2 px-4 border-b">Response and Remediation</th>
                        <th class="py-2 px-4 border-b">Attribution Analysis</th>
                        <th class="py-2 px-4 border-b">Lessons Learned</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Vishing compromised credentials. Why successful? No 2FA, weak training. Why weak? Underfunded security. Why underfunded? Prioritized features. Why prioritized? Growth focus. <br> <strong>Other causes</strong>: No DLP, no SIEM. <br> <strong>Beginners</strong>: Root causes trace to human factors. <br> <strong>Experts</strong>: Fishbone factors: People (untrained staff), Process (no 2FA), Technology (no IDS).</td>
                        <td class="py-2 px-4 border-b"><strong>Data</strong>: DMs, account data from 130 high-profile targets. <br> <strong>Financial</strong>: $120K stolen. <br> <strong>Reputational</strong>: Public embarrassment, stock dip. <br> <strong>Beginners</strong>: Impacts hit reputation, finances. <br> <strong>Experts</strong>: BIA metrics: RTO minutes for account lockout.</td>
                        <td class="py-2 px-4 border-b"><strong>Missed</strong>: Vishing via call monitoring; admin access via SIEM. <br> <strong>Opportunities</strong>: 2FA, employee training, DLP. <br> <strong>Failures</strong>: No IDS, no vishing awareness. <br> <strong>Beginners</strong>: Detection is like a phone alarm. <br> <strong>Experts</strong>: Sigma rule: `detection: logsource: category: admin | selection: access: unauthorized AND method: vishing`.</td>
                        <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Locked accounts, disabled admin tools. <br> <strong>Long-term</strong>: Enhanced 2FA, vishing training, SIEM. <br> <strong>Beginners</strong>: Response limits damage. <br> <strong>Experts</strong>: NIST IR followed: Identification (Jul 15), Containment (Jul 15), Eradication (Jul–).</td>
                        <td class="py-2 px-4 border-b"><strong>Confirmed</strong>: Clark, Sheppard, Fazeli (teen hackers). <br> <strong>TTPs</strong>: Vishing, account hijacking align with script kiddies. <br> <strong>Beginners</strong>: Attribution identifies culprits. <br> <strong>Experts</strong>: IOCs include Bitcoin wallet, admin tool logs.</td>
                        <td class="py-2 px-4 border-b">Enforce 2FA. <br> Train on vishing. <br> Deploy SIEM, DLP. <br> Monitor admin access. <br> <strong>Beginners</strong>: Secure logins, educate staff. <br> <strong>Experts</strong>: Adopt MITRE ATT&CK for social engineering defense.</td>
                    </tr>
                </tbody>
            </table>
        </div>
</body>
</html>
