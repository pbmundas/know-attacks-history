<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WannaCry (2017) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "WannaCry (2017)": {
                "name": "WannaCry Ransomware (2017) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1190",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Exploited EternalBlue SMB vulnerability",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "CVE-2017-0144 (MS17-010, CVSS 8.1)" },
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "SMBv1 exploit attempts, WannaCry payload (SHA256: ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa)" },
                            { "name": "Threat Actors", "value": "Lazarus Group (North Korean state-sponsored)" },
                            { "name": "Parameters", "value": "Network traffic (SMB), patch management records, IDS alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.003",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed ransomware via malicious payload",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows endpoints" },
                            { "name": "IOCs", "value": "WannaCry executable (wcry.exe, SHA256: 84c82835a5d21bbcf75a61706d8ab549), cmd.exe execution" },
                            { "name": "Parameters", "value": "Process execution logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1486",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Encrypted data with ransomware",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows file systems" },
                            { "name": "IOCs", "value": ".WNCRY file extensions, @WanaDecryptor@.exe" },
                            { "name": "Parameters", "value": "File system logs, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1078",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Used stolen credentials for propagation",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "Unauthorized admin logins from 192.168.x.x" },
                            { "name": "Parameters", "value": "Authentication logs, privilege escalation audit trails" }
                        ]
                    },
                    {
                        "techniqueID": "T1003",
                        "tactic": "credential-access",
                        "color": "#ffcc99",
                        "comment": "Dumped credentials to move laterally",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "Mimikatz execution (SHA256: 9b7f5d...), LSASS memory dumps" },
                            { "name": "Parameters", "value": "Memory analysis, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1082",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Collected system information for propagation",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "Systeminfo command output, net view execution" },
                            { "name": "Parameters", "value": "System logs, command execution logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1018",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Discovered remote systems via SMB",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Network infrastructure" },
                            { "name": "IOCs", "value": "SMB scanning traffic to 192.168.0.0/16" },
                            { "name": "Parameters", "value": "Network traffic analysis, system enumeration logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1570",
                        "tactic": "lateral-movement",
                        "color": "#ffcc99",
                        "comment": "Propagated via SMB protocol",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems, network shares" },
                            { "name": "IOCs", "value": "SMBv1 traffic spikes to 445/tcp, worm-like propagation" },
                            { "name": "Parameters", "value": "Network traffic (PCAP), EDR alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.002",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "Used SMB for C2 communication",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "Unusual SMB traffic to 185.86.148.0/24" },
                            { "name": "Parameters", "value": "Network traffic (PCAP), IDS/IPS alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1490",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Inhibited system recovery",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows systems" },
                            { "name": "IOCs", "value": "Disabled shadow copies via vssadmin delete shadows, @Please_Read_Me@.txt" },
                            { "name": "Parameters", "value": "System recovery logs, file system audits" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "WannaCry (2017)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "privilege-escalation",
                    "credential-access", "discovery", "lateral-movement", "command-and-control",
                    "collection", "exfiltration", "defense-evasion", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
								physics: {
								enabled: true
											},
								nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
								edges: { arrows: 'to', smooth: false },
								interaction: { dragNodes: true, dragView: true, zoomView: true }
								};
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                // Fit the network to the container
                network.fit();

                // Add resize listener
                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
				<a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">WannaCry (2017) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
							<br></br><strong>Background:</strong><br/>
							<p>WannaCry (2017): WannaCry was a global ransomware attack in May 2017, leveraging the EternalBlue exploit to infect unpatched Windows systems. It encrypted data and demanded ransoms, severely impacting healthcare, businesses, and infrastructure worldwide, with ties to North Korean hackers.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>