<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGM Resorts (2020) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "MGM Resorts (2020)": {
                "name": "MGM Resorts (2020) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1078",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Used valid accounts with compromised credentials for initial access",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Compromised credentials, lack of MFA" },
                            { "name": "Assets", "value": "Corporate network accounts" },
                            { "name": "IOCs", "value": "Anomalous login attempts from external IPs" },
                            { "name": "Threat Actors", "value": "Scattered Spider (UNC3944)" },
                            { "name": "Parameters", "value": "Authentication logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.001",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed commands via PowerShell for reconnaissance",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows servers, workstations" },
                            { "name": "IOCs", "value": "PowerShell execution of discovery commands" },
                            { "name": "Parameters", "value": "PowerShell logs, process execution logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1547",
                        "tactic": "persistence",
                        "color": "#ffcc99",
                        "comment": "Established persistence with scheduled tasks and registry modifications",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows registry, scheduled tasks" },
                            { "name": "IOCs", "value": "Scheduled tasks for backdoor execution" },
                            { "name": "Parameters", "value": "Registry monitoring, task scheduler logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1082",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Conducted network and system discovery using tools like BloodHound",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Active Directory, network infrastructure" },
                            { "name": "IOCs", "value": "BloodHound execution, AD enumeration" },
                            { "name": "Parameters", "value": "AD logs, network flow data" }
                        ]
                    },
                    {
                        "techniqueID": "T1570",
                        "tactic": "lateral-movement",
                        "color": "#ffcc99",
                        "comment": "Lateral movement using RDP and SMB with stolen credentials",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Domain-joined systems" },
                            { "name": "IOCs", "value": "Anomalous RDP/SMB connections" },
                            { "name": "Parameters", "value": "RDP logs, SMB session records" }
                        ]
                    },
                    {
                        "techniqueID": "T1005",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Collected sensitive data from file servers and databases",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "File servers, customer databases" },
                            { "name": "IOCs", "value": "Unauthorized file access, data staging" },
                            { "name": "Parameters", "value": "File access logs, DLP monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.001",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "HTTPS-based C2 communication to external servers",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Compromised hosts" },
                            { "name": "IOCs", "value": "HTTPS beacons to C2 domains" },
                            { "name": "Parameters", "value": "Proxy logs, DNS queries" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated 10.6 GB of customer data over several days",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Customer data, file servers" },
                            { "name": "IOCs", "value": "Large outbound data transfers" },
                            { "name": "Parameters", "value": "Network egress filtering, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1486",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Deployed ransomware to encrypt systems, demanding $30M ransom",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "File systems, critical servers" },
                            { "name": "IOCs", "value": "Encrypted files with ransom notes" },
                            { "name": "Parameters", "value": "File integrity monitoring, EDR alerts" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "MGM Resorts (2020)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "discovery",
                    "lateral-movement", "collection", "command-and-control",
                    "exfiltration", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                // Custom manual edges to ensure full connectivity
                const initialAccessNode = mitreData.techniques.findIndex(t => t.tactic === "initial-access") + 1;
                const executionNode = mitreData.techniques.findIndex(t => t.tactic === "execution") + 1;
                const persistenceNode = mitreData.techniques.findIndex(t => t.tactic === "persistence") + 1;
                const discoveryNode = mitreData.techniques.findIndex(t => t.tactic === "discovery") + 1;
                const lateralMovementNode = mitreData.techniques.findIndex(t => t.tactic === "lateral-movement") + 1;
                const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;
                const commandAndControlNode = mitreData.techniques.findIndex(t => t.tactic === "command-and-control") + 1;
                const exfiltrationNode = mitreData.techniques.findIndex(t => t.tactic === "exfiltration") + 1;
                const impactNode = mitreData.techniques.findIndex(t => t.tactic === "impact") + 1;

                // Initial Access → Execution
                if (initialAccessNode > 0 && executionNode > 0) {
                    edges.push({ from: initialAccessNode, to: executionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Execution → Persistence
                if (executionNode > 0 && persistenceNode > 0) {
                    edges.push({ from: executionNode, to: persistenceNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Persistence → Discovery
                if (persistenceNode > 0 && discoveryNode > 0) {
                    edges.push({ from: persistenceNode, to: discoveryNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Discovery → Lateral Movement
                if (discoveryNode > 0 && lateralMovementNode > 0) {
                    edges.push({ from: discoveryNode, to: lateralMovementNode, arrows: "to", color: { color: "red" }, dashes: true });
                }

                // Lateral Movement → Collection
                if (lateralMovementNode > 0 && collectionNode > 0) {
                    edges.push({ from: lateralMovementNode, to: collectionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Collection → Command and Control
                if (collectionNode > 0 && commandAndControlNode > 0) {
                    edges.push({ from: collectionNode, to: commandAndControlNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Command and Control → Exfiltration
                if (commandAndControlNode > 0 && exfiltrationNode > 0) {
                    edges.push({ from: commandAndControlNode, to: exfiltrationNode, arrows: "to", color: { color: "green" }, width: 2 });
                }

                // Exfiltration → Impact
                if (exfiltrationNode > 0 && impactNode > 0) {
                    edges.push({ from: exfiltrationNode, to: impactNode, arrows: "to", color: { color: "purple" }, width: 2 });
                }

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
                    physics: { enabled: true },
                    nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
                    edges: { arrows: 'to', smooth: false },
                    interaction: { dragNodes: true, dragView: true, zoomView: true }
                };
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                network.fit();

                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
                    <a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">MGM Resorts (2020) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
                            <br/><strong>Background:</strong><br/>
                            <p>The MGM Resorts cyberattack in September 2020 involved the hacking group Scattered Spider (UNC3944) compromising employee credentials to gain access to MGM's network. Attackers conducted reconnaissance using PowerShell, established persistence, enumerated Active Directory with BloodHound, moved laterally via RDP and SMB, collected 10.6 GB of customer data over several days, and exfiltrated it. They then deployed ransomware, encrypting systems and demanding a $30 million ransom, which MGM refused to pay, opting for restoration from backups. The attack disrupted operations at MGM properties, highlighting risks in credential security and third-party access.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
        <div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

  <!-- Attack Timeline -->
  <section>
          <h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Date/Time</th>
                        <th class="py-2 px-4 border-b">Action</th>
                        <th class="py-2 px-4 border-b">Actor/Details</th>
                        <th class="py-2 px-4 border-b">Evidence/Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">~July 7, 2019</td>
                        <td class="py-2 px-4 border-b">Initial access: Unauthorized access to MGM's cloud server.</td>
                        <td class="py-2 px-4 border-b">Unknown actor, possibly linked to GnosticPlayers</td>
                        <td class="py-2 px-4 border-b">Exploited employee credentials via credential stuffing; accessed 10.6M guest records.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 24, 2019</td>
                        <td class="py-2 px-4 border-b">Data purchase: MGM buys stolen data from attacker.</td>
                        <td class="py-2 px-4 border-b">MGM Resorts</td>
                        <td class="py-2 px-4 border-b">Purchased dataset to assess damage; data deemed poorly formatted, not readily usable.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">August 2019</td>
                        <td class="py-2 px-4 border-b">Notification: MGM notifies affected guests.</td>
                        <td class="py-2 px-4 border-b">MGM Resorts</td>
                        <td class="py-2 px-4 border-b">Notified customers per state laws; offered credit monitoring to some.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">February 19, 2020</td>
                        <td class="py-2 px-4 border-b">Public exposure: Stolen data posted on hacking forum.</td>
                        <td class="py-2 px-4 border-b">Under the Breach/ZDNet</td>
                        <td class="py-2 px-4 border-b">10.6M records, 3.1M unique emails exposed; included celebrities, CEOs, officials.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">February 21, 2020</td>
                        <td class="py-2 px-4 border-b">Lawsuit filed: Class-action lawsuit initiated against MGM.</td>
                        <td class="py-2 px-4 border-b">Plaintiff John Smallman</td>
                        <td class="py-2 px-4 border-b">Alleges negligence in securing customer data; case filed in U.S. District Court, Nevada.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">Mid-2020</td>
                        <td class="py-2 px-4 border-b">Dark web sale: 142M records offered for sale.</td>
                        <td class="py-2 px-4 border-b">Unknown actor</td>
                        <td class="py-2 px-4 border-b">Superset of 2019 data with 25M unique emails; likely from same incident.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">May 2022</td>
                        <td class="py-2 px-4 border-b">Data shared: Expanded dataset shared on Telegram.</td>
                        <td class="py-2 px-4 border-b">Unknown actor</td>
                        <td class="py-2 px-4 border-b">142M records, 25M unique emails; confirmed link to 2019 breach.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">January 22, 2025</td>
                        <td class="py-2 px-4 border-b">Settlement: $45M class-action settlement approved.</td>
                        <td class="py-2 px-4 border-b">MGM Resorts</td>
                        <td class="py-2 px-4 border-b">Covers 2019 and 2023 breaches; tiered payouts ($20–$75) based on data exposed.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Dwell Time Analysis -->
        <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
        <p class="mb-4">Dwell time was approximately 2–3 weeks (~July 7 to July 24, 2019), from initial access to detection, due to rapid response after unauthorized access was identified.</p>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Step 1: Initial Access (~Jul 7, 2019)</th>
                        <th class="py-2 px-4 border-b">Step 2: Collection/Spread (Jul 7–24, 2019)</th>
                        <th class="py-2 px-4 border-b">Step 3: Detection/Containment (Jul 24, 2019)</th>
                        <th class="py-2 px-4 border-b">Step 4: Recovery (Jul 2019–2025)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Credential stuffing on cloud server. <br><strong>What went wrong</strong>: No MFA, weak third-party platform security.</td>
                        <td class="py-2 px-4 border-b">10.6M records exfiltrated. <br><strong>Factor</strong>: No DLP, no anomaly detection.</td>
                        <td class="py-2 px-4 border-b">MGM detects breach, purchases data. <br><strong>Factor</strong>: Internal detection; rapid containment via purchase.</td>
                        <td class="py-2 px-4 border-b">Notified customers, settled lawsuits, enhanced security. <br><strong>Total time</strong>: $45M settlement, reputation damage.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time (~14–21 days vs. 2019 median ~78 days) was relatively short due to MGM’s detection and data purchase, but public exposure in 2020 amplified damage. Lack of MFA and weak third-party platform security enabled access; rapid containment limited further exfiltration.</p>

        <!-- Learnings -->
        <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                        <th class="py-2 px-4 border-b">Impact Assessment</th>
                        <th class="py-2 px-4 border-b">Detection Opportunities</th>
                        <th class="py-2 px-4 border-b">Response and Remediation</th>
                        <th class="py-2 px-4 border-b">Attribution Analysis</th>
                        <th class="py-2 px-4 border-b">Lessons Learned</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Credential stuffing. Why possible? No MFA. Why no MFA? Weak third-party platform. Why weak? No security audit. Why no audit? Cost focus. <br> <strong>Other causes</strong>: No DLP, outdated cloud security. <br> <strong>Beginners</strong>: Root causes trace to weak logins, poor cloud setup. <br> <strong>Experts</strong>: Fishbone factors: Process (no audits), Technology (no MFA), Third-Party (platform flaw).</td>
                        <td class="py-2 px-4 border-b"><strong>Data</strong>: 10.6M–142M records, 3.1M–25M emails, 1,300 sensitive IDs. <br> <strong>Financial</strong>: $45M settlement, legal costs. <br> <strong>Reputational</strong>: Trust erosion, lawsuits. <br> <strong>Beginners</strong>: Impacts hit finances, reputation. <br> <strong>Experts</strong>: BIA metrics: RPO months, RTO years for recovery.</td>
                        <td class="py-2 px-4 border-b"><strong>Missed</strong>: Credential stuffing via IDS; exfiltration via DLP. <br> <strong>Opportunities</strong>: MFA, cloud monitoring, third-party audits. <br> <strong>Failures</strong>: No IDS, no DLP. <br> <strong>Beginners</strong>: Detection is like antivirus. <br> <strong>Experts</strong>: Sigma rule: <code>detection: logsource: category: cloud | selection: access: unauthorized AND method: credential_stuffing</code>.</td>
                        <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Purchased data, notified customers. <br> <strong>Long-term</strong>: Added MFA, DLP, settled lawsuits. <br> <strong>Beginners</strong>: Response restores trust. <br> <strong>Experts</strong>: NIST IR followed: Identification (Jul 24), Containment (Jul–Aug), Eradication (Aug–).</td>
                        <td class="py-2 px-4 border-b"><strong>Suspected</strong>: GnosticPlayers (hacking group). <br> <strong>TTPs</strong>: Credential stuffing, cloud server exploit. <br> <strong>Beginners</strong>: Attribution identifies hackers. <br> <strong>Experts</strong>: IOCs include forum posts, stolen dataset hashes.</td>
                        <td class="py-2 px-4 border-b">Implement MFA. <br> Deploy DLP, cloud monitoring. <br> Audit third-party platforms. <br> Enhance incident response. <br> <strong>Beginners</strong>: Secure logins, monitor clouds. <br> <strong>Experts</strong>: Adopt MITRE ATT&CK, zero-trust for cloud.</td>
                    </tr>
                </tbody>
            </table>
        </div>
</body>
</html>
