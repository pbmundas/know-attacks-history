<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synnovis-NHS (2024) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "Synnovis-NHS (2024)": {
                "name": "Synnovis-NHS Ransomware (2024) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1195.001",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Compromised third-party systems",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Supply chain compromise" },
                            { "name": "Assets", "value": "Synnovis systems" },
                            { "name": "IOCs", "value": "Stolen credentials (e.g., synnovis_admin:pass123), phishing emails from nhs-update.com" },
                            { "name": "Threat Actors", "value": "Qilin Ransomware Gang" },
                            { "name": "Parameters", "value": "Authentication logs, phishing detection systems" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.001",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed ransomware payload",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "Qilin ransomware executable (qilin.exe, SHA256: 9a0b1c2d...)" },
                            { "name": "Parameters", "value": "Process execution logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1486",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Encrypted data with ransomware",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "Encrypted files with .qilin extension, QILIN_RECOVER.txt" },
                            { "name": "Parameters", "value": "File system logs, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1078",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Used stolen credentials for access",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "Unauthorized admin logins from 10.0.x.x" },
                            { "name": "Parameters", "value": "Authentication logs, privilege escalation audit trails" }
                        ]
                    },
                    {
                        "techniqueID": "T1003",
                        "tactic": "credential-access",
                        "color": "#ffcc99",
                        "comment": "Dumped credentials from systems",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "Mimikatz execution (SHA256: 3c4d5e6f...), LSASS memory dumps" },
                            { "name": "Parameters", "value": "Memory analysis, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1082",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Collected system information",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "Systeminfo command output, whoami execution" },
                            { "name": "Parameters", "value": "System logs, command execution logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1074.001",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Staged sensitive data for exfiltration",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare databases" },
                            { "name": "IOCs", "value": "Staged data in /tmp/nhs_data_export" },
                            { "name": "Parameters", "value": "File system logs, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated data for extortion",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare databases, external servers" },
                            { "name": "IOCs", "value": "Large data transfers to 185.86.148.0/24" },
                            { "name": "Parameters", "value": "Network traffic (PCAP), DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1489",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Disrupted healthcare services",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Healthcare systems" },
                            { "name": "IOCs", "value": "System outages, QILIN_RECOVER.txt ransom notes" },
                            { "name": "Parameters", "value": "System logs, service disruption reports" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "Synnovis-NHS (2024)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "privilege-escalation",
                    "credential-access", "discovery", "lateral-movement", "command-and-control",
                    "collection", "exfiltration", "defense-evasion", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

				// Add explicit cross-tactic links: execution -> privilege-escalation and discovery -> collection
				const addCrossTacticLinks = (fromTactic, toTactic) => {
					if (!tacticNodes[fromTactic] || !tacticNodes[toTactic]) return;
					tacticNodes[fromTactic].forEach(fromId => {
						tacticNodes[toTactic].forEach(toId => {
							// avoid duplicate edges
							const exists = edges.some(e => e.from === fromId && e.to === toId);
							if (!exists) edges.push({ from: fromId, to: toId, arrows: "to" });
						});
					});
				};

				addCrossTacticLinks("execution", "privilege-escalation");
				addCrossTacticLinks("discovery", "collection");


                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
								physics: {
								enabled: true
											},
								nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
								edges: { arrows: 'to', smooth: false },
								interaction: { dragNodes: true, dragView: true, zoomView: true }
								};
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                // Fit the network to the container
                network.fit();

                // Add resize listener
                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
				<a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">Synnovis-NHS (2024) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
							<br></br><strong>Background:</strong><br/>
							<p>Synnovis-NHS (2024): In 2024, the Synnovis-NHS attack by the Qilin gang encrypted pathology systems in London, severely impacting NHS services. The incident involved data theft and ransom demands, highlighting the vulnerability of healthcare networks to cybercrime.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
	<div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

        <!-- Attack Timeline -->
        <section>
            <h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
            <div class="overflow-x-auto mb-8">
                <table class="min-w-full bg-white border border-gray-300">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="py-2 px-4 border-b">Date/Time</th>
                            <th class="py-2 px-4 border-b">Action</th>
                            <th class="py-2 px-4 border-b">Actor/Details</th>
                            <th class="py-2 px-4 border-b">Evidence/Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border-b">April 2024</td>
                            <td class="py-2 px-4 border-b">Initial access: Spear-phishing emails with malicious attachments sent to Synnovis employees.</td>
                            <td class="py-2 px-4 border-b">Qilin Ransomware Group</td>
                            <td class="py-2 px-4 border-b">Employee opened attachment, installing ransomware payload.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">April–May 2024</td>
                            <td class="py-2 px-4 border-b">Lateral movement: Attackers map network, escalate privileges to admin accounts.</td>
                            <td class="py-2 px-4 border-b">Qilin Ransomware Group</td>
                            <td class="py-2 px-4 border-b">Undetected due to lack of network segmentation and monitoring.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">May 20, 2024</td>
                            <td class="py-2 px-4 border-b">Data exfiltration: Sensitive patient data stolen from Synnovis systems.</td>
                            <td class="py-2 px-4 border-b">Qilin Ransomware Group</td>
                            <td class="py-2 px-4 border-b">4.3TB of patient records exfiltrated; no alerts triggered.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">June 3, 2024, 12:30 AM (GMT)</td>
                            <td class="py-2 px-4 border-b">Ransomware deployment: Systems encrypted, ransom note delivered.</td>
                            <td class="py-2 px-4 border-b">Qilin Ransomware Group</td>
                            <td class="py-2 px-4 border-b">Pathology services disrupted; NHS hospitals impacted.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">June 3, 2024, 8:00 AM (GMT)</td>
                            <td class="py-2 px-4 border-b">Detection: System outages and ransom note identified.</td>
                            <td class="py-2 px-4 border-b">Synnovis IT Staff</td>
                            <td class="py-2 px-4 border-b">Reported to NHS; critical services at Guy’s and St Thomas’ affected.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">June 4, 2024</td>
                            <td class="py-2 px-4 border-b">Response initiated: Cybersecurity firms and NCSC engaged.</td>
                            <td class="py-2 px-4 border-b">NHS, Synnovis, NCSC</td>
                            <td class="py-2 px-4 border-b">Incident response activated; public notified of breach.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">June 10, 2024</td>
                            <td class="py-2 px-4 border-b">Data leak: Stolen data published on dark web.</td>
                            <td class="py-2 px-4 border-b">Qilin Ransomware Group</td>
                            <td class="py-2 px-4 border-b">Patient data exposed after ransom non-payment; reputational harm.</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 border-b">July 2024</td>
                            <td class="py-2 px-4 border-b">Investigation: Attack attributed to Qilin group.</td>
                            <td class="py-2 px-4 border-b">UK NCSC, Law Enforcement</td>
                            <td class="py-2 px-4 border-b">Linked to Qilin via ransomware signatures and TTPs.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Dwell Time Analysis -->
        <section>
            <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
            <p class="mb-4">Dwell time was approximately 2 months (April 2024 to June 3, 2024), allowing attackers to infiltrate, exfiltrate data, and deploy ransomware undetected.</p>
            <div class="overflow-x-auto mb-8">
                <table class="min-w-full bg-white border border-gray-300">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="py-2 px-4 border-b">Step 1: Initial Access (April 2024)</th>
                            <th class="py-2 px-4 border-b">Step 2: Lateral Movement (April–May 2024)</th>
                            <th class="py-2 px-4 border-b">Step 3: Collection/Exfiltration (May 20, 2024)</th>
                            <th class="py-2 px-4 border-b">Step 4: Ransomware Deployment (June 3, 2024)</th>
                            <th class="py-2 px-4 border-b">Step 5: Detection (June 3, 2024)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border-b">Spear-phishing with malicious attachment.<br><strong>What went wrong</strong>: No email filtering, weak user training.</td>
                            <td class="py-2 px-4 border-b">Navigated network, escalated to admin accounts.<br><strong>Factor</strong>: No network segmentation, no IDS/IPS.</td>
                            <td class="py-2 px-4 border-b">Exfiltrated 4.3TB of patient data.<br><strong>Factor</strong>: No data loss prevention (DLP) tools.</td>
                            <td class="py-2 px-4 border-b">Deployed ransomware, encrypted systems.<br><strong>Factor</strong>: No real-time endpoint monitoring.</td>
                            <td class="py-2 px-4 border-b">Detected after systems offline, ransom note found.<br><strong>Total time</strong>: Enabled data theft and service disruption.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time was like a thief hiding in a hospital for weeks, unnoticed due to weak security controls. Industry reports suggest median dwell times in 2024 were ~21 days; Synnovis’ 2 months was above average, enabling extensive data theft and disruption.</p>
        </section>

        <!-- Learnings -->
        <section>
            <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-300">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                            <th class="py-2 px-4 border-b">Impact Assessment</th>
                            <th class="py-2 px-4 border-b">Detection Opportunities</th>
                            <th class="py-2 px-4 border-b">Response and Remediation</th>
                            <th class="py-2 px-4 border-b">Attribution Analysis</th>
                            <th class="py-2 px-4 border-b">Lessons Learned</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Phishing delivered ransomware. Why successful? No email filters, weak training. Why weak? Underfunded security. Why underfunded? Healthcare budget constraints. Why constrained? NHS funding priorities.<br><strong>Other causes</strong>: No MFA, weak endpoint security.<br><strong>Beginners</strong>: Root causes trace to poor defenses.<br><strong>Experts</strong>: Fishbone factors: People (untrained staff), Process (no MFA), Technology (no EDR).</td>
                            <td class="py-2 px-4 border-b"><strong>Operational</strong>: Pathology services disrupted, delaying patient care.<br><strong>Reputational</strong>: Loss of trust in NHS data security.<br><strong>Data</strong>: 4.3TB patient data exposed.<br><strong>Beginners</strong>: Impacts hit operations, trust.<br><strong>Experts</strong>: BIA metrics: RTO violated due to prolonged outages.</td>
                            <td class="py-2 px-4 border-b"><strong>Missed</strong>: Phishing via email filters; lateral movement via IDS; exfiltration via DLP.<br><strong>Opportunities</strong>: Deploy MFA, EDR, SIEM; audit admin access.<br><strong>Failures</strong>: No real-time monitoring, ignored early anomalies.<br><strong>Beginners</strong>: Detection is like a hospital alarm.<br><strong>Experts</strong>: Sigma rule: <code>detection: logsource: category: ransomware | selection: encryption: unauthorized</code>.</td>
                            <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Isolated systems, engaged NCSC, notified patients.<br><strong>Long-term</strong>: Deployed MFA, EDR; enhanced staff training.<br><strong>Beginners</strong>: Response limits damage.<br><strong>Experts</strong>: NIST IR followed: Identification (June 3), Containment (June 4), Recovery (ongoing).</td>
                            <td class="py-2 px-4 border-b"><strong>Confirmed</strong>: Qilin Ransomware Group.<br><strong>TTPs</strong>: Phishing, data exfiltration, ransomware align with Qilin’s methods.<br><strong>Beginners</strong>: Attribution identifies hackers.<br><strong>Experts</strong>: TTPs match Qilin; IOCs include ransomware signatures, C2 domains.</td>
                            <td class="py-2 px-4 border-b">Enforce MFA, email filtering.<br>Segment networks, secure endpoints.<br>Deploy SIEM, DLP, EDR.<br>Train staff on phishing.<br>Enhance incident response plans.<br><strong>Beginners</strong>: Secure systems, educate employees.<br><strong>Experts</strong>: Adopt MITRE ATT&CK, NHS Cyber Security Framework.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

    </div>
</body>
</html>

