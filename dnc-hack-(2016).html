<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNC Hack (2016) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "DNC Hack (2016)": {
                "name": "DNC Hack (2016) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1566.002",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Used spear-phishing for initial access",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Social engineering" },
                            { "name": "Assets", "value": "Employee endpoints" },
                            { "name": "IOCs", "value": "Phishing emails with malicious links" },
                            { "name": "Threat Actors", "value": "Cozy Bear, Fancy Bear (Russian state-sponsored)" },
                            { "name": "Parameters", "value": "Email logs, phishing detection systems" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.001",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed malware via phishing links",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Employee endpoints" },
                            { "name": "IOCs", "value": "Malicious executable downloads" },
                            { "name": "Parameters", "value": "Process execution logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1505.003",
                        "tactic": "persistence",
                        "color": "#ffcc99",
                        "comment": "Deployed persistent malware",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC servers" },
                            { "name": "IOCs", "value": "Malicious executables, scheduled tasks" },
                            { "name": "Parameters", "value": "File system logs, registry monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1078",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Used stolen credentials for access",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC servers" },
                            { "name": "IOCs", "value": "Unauthorized admin logins" },
                            { "name": "Parameters", "value": "Authentication logs, privilege escalation audit trails" }
                        ]
                    },
                    {
                        "techniqueID": "T1003",
                        "tactic": "credential-access",
                        "color": "#ffcc99",
                        "comment": "Dumped credentials from systems",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC servers" },
                            { "name": "IOCs", "value": "Mimikatz usage, LSASS memory dumps" },
                            { "name": "Parameters", "value": "Memory analysis, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1082",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Collected system information",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC servers" },
                            { "name": "IOCs", "value": "Systeminfo command output" },
                            { "name": "Parameters", "value": "System logs, command execution logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1083",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Enumerated email databases",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC email servers" },
                            { "name": "IOCs", "value": "SQL query execution, database access logs" },
                            { "name": "Parameters", "value": "Database query logs, network traffic analysis" }
                        ]
                    },
                    {
                        "techniqueID": "T1074.001",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Staged email data for exfiltration",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC email servers" },
                            { "name": "IOCs", "value": "Staged data in temporary folders" },
                            { "name": "Parameters", "value": "File system logs, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated email data",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "DNC email servers, external servers" },
                            { "name": "IOCs", "value": "Large data transfers to external IPs" },
                            { "name": "Parameters", "value": "Network traffic (PCAP), DLP alerts" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "DNC Hack (2016)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "privilege-escalation",
                    "credential-access", "discovery", "lateral-movement", "command-and-control",
                    "collection", "exfiltration", "defense-evasion", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

				// --- Custom manual edge: Credential Access â†’ Collection ---
				const credAccessNode = mitreData.techniques.findIndex(t => t.tactic === "credential-access") + 1;
				const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;

				if (credAccessNode > 0 && collectionNode > 0) {
					edges.push({
						from: credAccessNode,
						to: collectionNode,
						arrows: "to",
						color: { color: "blue" },
						width: 2
					});
				}


                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
								physics: {
								enabled: true
											},
								nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
								edges: { arrows: 'to', smooth: false },
								interaction: { dragNodes: true, dragView: true, zoomView: true }
								};
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                // Fit the network to the container
                network.fit();

                // Add resize listener
                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4 relative">
				<a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">DNC Hack (2016) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
							<br></br><strong>Background:</strong><br/>
							<p>DNC Hack (2016): The 2016 Democratic National Committee hack involved spear-phishing by Russian groups Cozy Bear and Fancy Bear, leading to the leak of sensitive emails. This politically motivated attack influenced public discourse during the U.S. election cycle.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
	<div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

  <!-- Attack Timeline -->
  <section>
	<h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Date/Time</th>
                        <th class="py-2 px-4 border-b">Action</th>
                        <th class="py-2 px-4 border-b">Actor/Details</th>
                        <th class="py-2 px-4 border-b">Evidence/Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">June 2015</td>
                        <td class="py-2 px-4 border-b">Initial access (Cozy Bear): Spear-phishing email compromises DNC employee credentials.</td>
                        <td class="py-2 px-4 border-b">Cozy Bear (APT29, FSB-linked)</td>
                        <td class="py-2 px-4 border-b">Undetected; installed X-Agent malware for persistent access.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">September 2015</td>
                        <td class="py-2 px-4 border-b">Initial access (Fancy Bear): Separate spear-phishing campaign targets DNC network.</td>
                        <td class="py-2 px-4 border-b">Fancy Bear (APT28, GRU-linked)</td>
                        <td class="py-2 px-4 border-b">Installed X-Agent; focused on email and document theft.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">September 2015â€“March 2016</td>
                        <td class="py-2 px-4 border-b">Lateral movement and data collection: Both groups navigate network, steal emails and documents.</td>
                        <td class="py-2 px-4 border-b">Cozy Bear, Fancy Bear</td>
                        <td class="py-2 px-4 border-b">Exfiltrated 19,000+ emails; undetected due to weak monitoring.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">March 2016</td>
                        <td class="py-2 px-4 border-b">Data staging: Attackers prepare stolen data for public release.</td>
                        <td class="py-2 px-4 border-b">Fancy Bear</td>
                        <td class="py-2 px-4 border-b">Organized emails for strategic leaks; no alerts triggered.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">April 2016</td>
                        <td class="py-2 px-4 border-b">Detection attempt: DNC IT staff notice unusual activity, hire CrowdStrike.</td>
                        <td class="py-2 px-4 border-b">DNC/CrowdStrike</td>
                        <td class="py-2 px-4 border-b">Confirmed two separate intrusions; Cozy Bear and Fancy Bear identified.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 12, 2016</td>
                        <td class="py-2 px-4 border-b">Data leak begins: Guccifer 2.0, a Fancy Bear persona, posts stolen DNC documents on WordPress.</td>
                        <td class="py-2 px-4 border-b">Fancy Bear</td>
                        <td class="py-2 px-4 border-b">Released opposition research on Trump; claimed to be lone hacker.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 14, 2016</td>
                        <td class="py-2 px-4 border-b">DNC confirms breach: CrowdStrike publicly attributes attack to Russian groups.</td>
                        <td class="py-2 px-4 border-b">DNC/CrowdStrike</td>
                        <td class="py-2 px-4 border-b">Named Cozy Bear and Fancy Bear; linked to Russian government.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 22, 2016</td>
                        <td class="py-2 px-4 border-b">Major leak: WikiLeaks publishes 19,252 DNC emails and 8,034 attachments.</td>
                        <td class="py-2 px-4 border-b">Fancy Bear via WikiLeaks</td>
                        <td class="py-2 px-4 border-b">Exposed DNC bias against Sanders; fueled political controversy.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 25, 2016</td>
                        <td class="py-2 px-4 border-b">Fallout: DNC chair Debbie Wasserman Schultz resigns.</td>
                        <td class="py-2 px-4 border-b">DNC</td>
                        <td class="py-2 px-4 border-b">Resignation due to public backlash over email revelations.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">Julyâ€“October 2016</td>
                        <td class="py-2 px-4 border-b">Further leaks: Additional DNC and Podesta emails released via WikiLeaks.</td>
                        <td class="py-2 px-4 border-b">Fancy Bear</td>
                        <td class="py-2 px-4 border-b">Targeted Clinton campaign chair John Podesta; amplified election interference.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">October 7, 2016</td>
                        <td class="py-2 px-4 border-b">U.S. government statement: DHS and ODNI attribute hacks to Russia.</td>
                        <td class="py-2 px-4 border-b">U.S. Government</td>
                        <td class="py-2 px-4 border-b">Confirmed intent to influence U.S. election.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">December 29, 2016</td>
                        <td class="py-2 px-4 border-b">U.S. response: Obama administration imposes sanctions on Russia, expels 35 diplomats.</td>
                        <td class="py-2 px-4 border-b">U.S. Government</td>
                        <td class="py-2 px-4 border-b">Targeted GRU, FSB; released IOCs via GRIZZLY STEPPE report.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 13, 2018</td>
                        <td class="py-2 px-4 border-b">Indictments: Mueller investigation charges 12 GRU officers for DNC hack.</td>
                        <td class="py-2 px-4 border-b">U.S. DOJ</td>
                        <td class="py-2 px-4 border-b">Linked to Fancy Bear; detailed spear-phishing and leak tactics.</td>
                    </tr>
                </tbody>
            </table>
			</br><a href="https://github.com/pbmundas/Threat-Hunting/blob/main/Learning%20through%20known%20attacks/DNC%20Hack%20(2016).md" target="_blank" className="text-blue-600 hover:underline absolute top-4 right-4" style="color:blue;">Understand how to hunt such attacks</a> 
        </div>

        <!-- Dwell Time Analysis -->
        <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
        <p class="mb-4">Dwell time was approximately 10 months for Cozy Bear (June 2015â€“April 2016) and 7 months for Fancy Bear (September 2015â€“April 2016), allowing extensive data theft and preparation for leaks.</p>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Step 1: Initial Access (Jun/Sep 2015)</th>
                        <th class="py-2 px-4 border-b">Step 2: Lateral Movement (Sep 2015â€“Mar 2016)</th>
                        <th class="py-2 px-4 border-b">Step 3: Collection/Exfiltration (Sep 2015â€“Mar 2016)</th>
                        <th class="py-2 px-4 border-b">Step 4: Data Leakage (Junâ€“Jul 2016)</th>
                        <th class="py-2 px-4 border-b">Step 5: Detection (Apr 2016)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Spear-phishing compromised credentials. <br><strong>What went wrong</strong>: No 2FA, weak email filters.</td>
                        <td class="py-2 px-4 border-b">Navigated network, accessed email servers. <br><strong>Factor</strong>: No segmentation, no IDS.</td>
                        <td class="py-2 px-4 border-b">Stole 19,000+ emails, documents. <br><strong>Factor</strong>: No DLP or anomaly detection.</td>
                        <td class="py-2 px-4 border-b">Leaked data via Guccifer 2.0, WikiLeaks. <br><strong>Factor</strong>: No exfiltration monitoring.</td>
                        <td class="py-2 px-4 border-b">Detected via unusual activity; CrowdStrike engaged. <br><strong>Total time</strong>: Enabled election interference.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time was like spies infiltrating a campaign headquarters for months, unnoticed due to poor defenses. Industry reports suggest median dwell times in 2016 were ~150 days; the DNCâ€™s 7â€“10 months was prolonged, enabling significant data theft and strategic leaks.</p>

        <!-- Learnings -->
        <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                        <th class="py-2 px-4 border-b">Impact Assessment</th>
                        <th class="py-2 px-4 border-b">Detection Opportunities</th>
                        <th class="py-2 px-4 border-b">Response and Remediation</th>
                        <th class="py-2 px-4 border-b">Attribution Analysis</th>
                        <th class="py-2 px-4 border-b">Lessons Learned</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Phishing compromised credentials. Why successful? No 2FA, weak training. Why weak? Underfunded cybersecurity. Why underfunded? Political organization priorities. Why prioritized? Budget focus on campaigns. <br> <strong>Other causes</strong>: No DLP, no SIEM, outdated systems. <br> <strong>Beginners</strong>: Root causes trace to lax security. <br> <strong>Experts</strong>: Fishbone factors: People (untrained staff), Process (no 2FA), Technology (no IDS).</td>
                        <td class="py-2 px-4 border-b"><strong>Data</strong>: 19,000+ emails, documents stolen. <br> <strong>Reputational</strong>: DNC trust eroded; Schultz resigned. <br> <strong>Political</strong>: Fueled election controversy, Sanders-Clinton rift. <br> <strong>Beginners</strong>: Impacts hit reputation, politics. <br> <strong>Experts</strong>: BIA metrics: RPO violated due to data exposure.</td>
                        <td class="py-2 px-4 border-b"><strong>Missed</strong>: Phishing via email filters; lateral movement via IDS; exfiltration via DLP. <br> <strong>Opportunities</strong>: Deploy 2FA, SIEM, DLP; train staff. <br> <strong>Failures</strong>: No monitoring, ignored alerts. <br> <strong>Beginners</strong>: Detection is like a security camera. <br> <strong>Experts</strong>: Sigma rule: <code>detection: logsource: category: email | selection: attachment: malicious OR sender: unknown</code>.</td>
                        <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Engaged CrowdStrike, took systems offline. <br> <strong>Long-term</strong>: Improved 2FA, monitoring; hired cybersecurity staff. <br> <strong>Beginners</strong>: Response limits damage. <br> <strong>Experts</strong>: NIST IR followed: Identification (Apr 2016), Containment (Apr 2016), Eradication (post-Apr).</td>
                        <td class="py-2 px-4 border-b"><strong>Confirmed</strong>: Fancy Bear (GRU), Cozy Bear (FSB), indicted 2018. <br> <strong>TTPs</strong>: Phishing, X-Agent malware, leaks align with state-sponsored actors. <br> <strong>Beginners</strong>: Attribution identifies hackers. <br> <strong>Experts</strong>: TTPs match APT28/APT29; IOCs include X-Agent hashes, Russian IPs.</td>
                        <td class="py-2 px-4 border-b">Enforce 2FA, email filtering. <br> Segment networks. <br> Deploy SIEM, DLP, EDR. <br> Train staff on phishing. <br> Fund cybersecurity. <br> <strong>Beginners</strong>: Secure systems, educate employees. <br> <strong>Experts</strong>: Adopt MITRE ATT&CK for defense.</td>
                    </tr>
                </tbody>
            </table>
        </div>
</body>
</html>


