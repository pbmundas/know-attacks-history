<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Breach (2012) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "LinkedIn (2012)": {
                "name": "LinkedIn Breach (2012) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1190",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Exploited a SQL injection vulnerability to access LinkedIn’s production database",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "SQL injection in web application" },
                            { "name": "Assets", "value": "Production database" },
                            { "name": "IOCs", "value": "Malicious SQL queries in logs" },
                            { "name": "Threat Actors", "value": "Russian cybercriminals, Yevgeniy Nikulin" },
                            { "name": "Parameters", "value": "Web application logs, input validation monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1059",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed SQL injection payloads to query and extract database contents",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Database server" },
                            { "name": "IOCs", "value": "Unauthorized SQL query execution" },
                            { "name": "Parameters", "value": "Database query logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1098",
                        "tactic": "persistence",
                        "color": "#ffcc99",
                        "comment": "Maintained access to the compromised database environment, likely through persistent SQL injection exploitation",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Database server" },
                            { "name": "IOCs", "value": "Repeated unauthorized database access" },
                            { "name": "Parameters", "value": "Session monitoring, database access logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1005",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Collected usernames and unsalted SHA-1 hashed passwords from the production database",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "User credentials, database" },
                            { "name": "IOCs", "value": "Unauthorized data extraction" },
                            { "name": "Parameters", "value": "Database access logs, DLP monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.001",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "Established communication with attacker-controlled infrastructure to manage the attack and coordinate data extraction",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Compromised database server" },
                            { "name": "IOCs", "value": "HTTPS beacons to attacker servers" },
                            { "name": "Parameters", "value": "Network traffic analysis, DNS queries" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated 167 million user records, including 117 million email and password combinations, to attacker-controlled servers",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "User credentials" },
                            { "name": "IOCs", "value": "Outbound data transfers to dark web servers" },
                            { "name": "Parameters", "value": "Network egress filtering, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1490",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Inhibited system recovery by exposing sensitive data, necessitating password resets and system remediation",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "User accounts, database" },
                            { "name": "IOCs", "value": "Mass password reset activities" },
                            { "name": "Parameters", "value": "System change logs, authentication records" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "LinkedIn (2012)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "collection",
                    "command-and-control", "exfiltration", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                // Custom manual edges to ensure full connectivity
                const initialAccessNode = mitreData.techniques.findIndex(t => t.tactic === "initial-access") + 1;
                const executionNode = mitreData.techniques.findIndex(t => t.tactic === "execution") + 1;
                const persistenceNode = mitreData.techniques.findIndex(t => t.tactic === "persistence") + 1;
                const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;
                const commandAndControlNode = mitreData.techniques.findIndex(t => t.tactic === "command-and-control") + 1;
                const exfiltrationNode = mitreData.techniques.findIndex(t => t.tactic === "exfiltration") + 1;
                const impactNode = mitreData.techniques.findIndex(t => t.tactic === "impact") + 1;

                // Initial Access → Execution
                if (initialAccessNode > 0 && executionNode > 0) {
                    edges.push({ from: initialAccessNode, to: executionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Execution → Persistence
                if (executionNode > 0 && persistenceNode > 0) {
                    edges.push({ from: executionNode, to: persistenceNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Persistence → Collection
                if (persistenceNode > 0 && collectionNode > 0) {
                    edges.push({ from: persistenceNode, to: collectionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Collection → Command and Control
                if (collectionNode > 0 && commandAndControlNode > 0) {
                    edges.push({ from: collectionNode, to: commandAndControlNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Command and Control → Exfiltration
                if (commandAndControlNode > 0 && exfiltrationNode > 0) {
                    edges.push({ from: commandAndControlNode, to: exfiltrationNode, arrows: "to", color: { color: "green" }, width: 2 });
                }

                // Exfiltration → Impact
                if (exfiltrationNode > 0 && impactNode > 0) {
                    edges.push({ from: exfiltrationNode, to: impactNode, arrows: "to", color: { color: "purple" }, width: 2 });
                }

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
                    physics: { enabled: true },
                    nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
                    edges: { arrows: 'to', smooth: false },
                    interaction: { dragNodes: true, dragView: true, zoomView: true }
                };
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                network.fit();

                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
                    <a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">LinkedIn Breach (2012) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
                            <br/><strong>Background:</strong><br/>
                            <p>The LinkedIn breach, disclosed on June 5, 2012, initially compromised 6.5 million user accounts but was later revealed in 2016 to have affected 167 million accounts, with 117 million email and password combinations exposed. Russian cybercriminals, including Yevgeniy Nikulin, likely exploited a SQL injection vulnerability to access the production database. Passwords were hashed with SHA-1 but not salted, enabling 90% to be cracked within 72 hours. The data was posted on a Russian hacking forum and sold on the dark web. LinkedIn invalidated affected passwords, urged resets, and implemented salting and stronger encryption post-breach.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
        <div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

  <!-- Attack Timeline -->
  <section>
        <!-- Attack Timeline -->
        <h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Date/Time</th>
                        <th class="py-2 px-4 border-b">Action</th>
                        <th class="py-2 px-4 border-b">Actor/Details</th>
                        <th class="py-2 px-4 border-b">Evidence/Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Early 2012</td>
                        <td class="py-2 px-4 border-b">Initial breach: Attackers exploit unspecified vulnerability in LinkedIn’s database.</td>
                        <td class="py-2 px-4 border-b">Russian cybercriminals (suspected)</td>
                        <td class="py-2 px-4 border-b">Accessed unsalted SHA-1 hashed passwords and emails.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">March-April 2012</td>
                        <td class="py-2 px-4 border-b">Data exfiltration: ~6.5 million account credentials stolen.</td>
                        <td class="py-2 px-4 border-b">Attackers</td>
                        <td class="py-2 px-4 border-b">Data staged for exfiltration; no immediate detection.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 5, 2012</td>
                        <td class="py-2 px-4 border-b">Stolen data posted on Russian hacker forum, requesting Bitcoin payment.</td>
                        <td class="py-2 px-4 border-b">Hacker “Peace”</td>
                        <td class="py-2 px-4 border-b">6.5 million unsalted SHA-1 hashes exposed; passwords cracked.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 6, 2012</td>
                        <td class="py-2 px-4 border-b">LinkedIn confirms breach after user reports; initiates investigation.</td>
                        <td class="py-2 px-4 border-b">LinkedIn</td>
                        <td class="py-2 px-4 border-b">Public disclosure; password reset emails sent to affected users.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 2012</td>
                        <td class="py-2 px-4 border-b">Remediation: LinkedIn invalidates exposed passwords, notifies users.</td>
                        <td class="py-2 px-4 border-b">LinkedIn</td>
                        <td class="py-2 px-4 border-b">No immediate financial loss reported; reputational hit.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">May 2016</td>
                        <td class="py-2 px-4 border-b">Additional 117 million records from 2012 breach surface on dark web.</td>
                        <td class="py-2 px-4 border-b">Hacker “Peace”</td>
                        <td class="py-2 px-4 border-b">Total impact: 167 million accounts; LinkedIn confirms expanded scope.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 2016</td>
                        <td class="py-2 px-4 border-b">Enhanced remediation: Additional password resets, bcrypt hashing implemented.</td>
                        <td class="py-2 px-4 border-b">LinkedIn</td>
                        <td class="py-2 px-4 border-b">$1-5 million estimated remediation costs; lawsuits filed.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">2017</td>
                        <td class="py-2 px-4 border-b">Legal resolution: LinkedIn settles class-action lawsuit for $1.25 million.</td>
                        <td class="py-2 px-4 border-b">LinkedIn</td>
                        <td class="py-2 px-4 border-b">Ongoing trust erosion; regulatory scrutiny increased.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Dwell Time Analysis -->
        <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
        <p class="mb-4">Dwell time was approximately 60-90 days (early 2012 to June 5, 2012), the period attackers operated undetected in LinkedIn’s systems. This allowed data collection and exfiltration before public exposure.</p>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Step 1: Initial Access (Early 2012)</th>
                        <th class="py-2 px-4 border-b">Step 2: Collection (March-April)</th>
                        <th class="py-2 px-4 border-b">Step 3: Exfiltration (March-April)</th>
                        <th class="py-2 px-4 border-b">Step 4: Detection (June 5, 2012)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Exploited unspecified database vulnerability. <br><strong>What went wrong</strong>: Unpatched system or weak access controls.</td>
                        <td class="py-2 px-4 border-b">Queried database for user credentials (unsalted SHA-1 hashes, emails). <br><strong>Factor</strong>: No anomaly detection for database queries.</td>
                        <td class="py-2 px-4 border-b">Exfiltrated ~6.5 million (later 117 million) records to external servers. <br><strong>Factor</strong>: No egress filtering or DLP.</td>
                        <td class="py-2 px-4 border-b">Hacker posted data publicly, triggering LinkedIn’s response. <br><strong>Total time</strong>: Enabled theft of 167 million accounts.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time was like a thief looting a vault unnoticed, amplified by weak hashing. Experts: Median dwell time in 2012 was ~200 days (per Mandiant); LinkedIn’s 60-90 days was typical but damaging due to unsalted hashes.</p>

        <!-- Learnings -->
        <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                        <th class="py-2 px-4 border-b">Impact Assessment</th>
                        <th class="py-2 px-4 border-b">Detection Opportunities</th>
                        <th class="py-2 px-4 border-b">Response and Remediation</th>
                        <th class="py-2 px-4 border-b">Attribution Analysis</th>
                        <th class="py-2 px-4 border-b">Lessons Learned</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Database vulnerability. Why exploited? Unpatched or misconfigured system. Why unpatched? No asset inventory or patch management. Why no inventory? Siloed security practices. Why siloed? Prioritized growth over security. <br> <strong>Other causes</strong>: Unsalted SHA-1 hashes, no DLP for exfiltration, short log retention. <br> <strong>Beginners</strong>: Root causes trace failure points. <br> <strong>Experts</strong>: Fishbone factors: Technology (weak hashing), Process (no patch policy), People (security oversight).</td>
                        <td class="py-2 px-4 border-b"><strong>Data</strong>: 167 million accounts (emails, unsalted SHA-1 hashes). <br> <strong>Financial</strong>: $1-5M remediation; $1.25M lawsuit settlement. <br> <strong>Reputational</strong>: Trust erosion; user churn reported. <br> <strong>Regulatory</strong>: Increased scrutiny; GDPR precursor concerns. <br> <strong>Beginners</strong>: Impacts hit users and brand. <br> <strong>Experts</strong>: BIA metrics: RTO delayed by public exposure.</td>
                        <td class="py-2 px-4 border-b"><strong>Missed</strong>: Query spikes could have been caught with SIEM; exfiltration with DLP. <br> <strong>Opportunities</strong>: Monitor database access, deploy DLP, use salted hashes (e.g., bcrypt). <br> <strong>Failures</strong>: No query anomaly detection, no egress controls. <br> <strong>Beginners</strong>: Detection is like a burglar alarm. <br> <strong>Experts</strong>: Sigma rule example: <code>detection: logsource: category: database | selection: event: query_count > 500 in 1h</code>.</td>
                        <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Invalidated passwords, notified users, investigated scope. <br> <strong>Long-term</strong>: Implemented bcrypt, enhanced DLP, improved patch management. <br> <strong>Beginners</strong>: Response is cleanup. <br> <strong>Experts</strong>: Followed NIST IR: Identification (June), Containment (June), Eradication (2016).</td>
                        <td class="py-2 px-4 border-b"><strong>Suspected</strong>: Russian cybercriminals (hacker “Peace”). <br> <strong>TTPs</strong>: Database exploitation, dark web data sale align with cybercrime groups. <br> <strong>Beginners</strong>: Attribution is identifying culprits. <br> <strong>Experts</strong>: TTPs match Russian data breach patterns; limited IOCs due to dark web anonymity.</td>
                        <td class="py-2 px-4 border-b">Use strong hashing (e.g., bcrypt). <br> Patch systems promptly. <br> Deploy DLP and SIEM. <br> Maintain asset inventories. <br> Monitor database queries. <br> <strong>Beginners</strong>: Secure data storage. <br> <strong>Experts</strong>: Adopt MITRE ATT&CK for data breach defense.</td>
                    </tr>
                </tbody>
            </table>
        </div>
</body>
</html>
