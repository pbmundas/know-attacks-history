<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA SecurID (2011) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "RSA SecurID (2011)": {
                "name": "RSA SecurID (2011) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1566.001",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Spearphishing via email with malicious Excel attachment exploiting Adobe Flash zero-day",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Adobe Flash zero-day, phishing susceptibility" },
                            { "name": "Assets", "value": "Employee email accounts" },
                            { "name": "IOCs", "value": "Phishing emails with '2011 Recruitment Plan.xls'" },
                            { "name": "Threat Actors", "value": "Chinese state-sponsored group (suspected PLA Unit 61398)" },
                            { "name": "Parameters", "value": "Email gateway logs, user click tracking" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.001",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed Poison Ivy malware via phishing payload",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Employee workstations" },
                            { "name": "IOCs", "value": "Poison Ivy malware execution (SHA256: varies)" },
                            { "name": "Parameters", "value": "Process execution logs, EDR telemetry" }
                        ]
                    },
                    {
                        "techniqueID": "T1547",
                        "tactic": "persistence",
                        "color": "#ffcc99",
                        "comment": "Backdoors established for sustained network access",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Windows registry, compromised systems" },
                            { "name": "IOCs", "value": "Backdoor services, registry keys in HKLM\\SYSTEM" },
                            { "name": "Parameters", "value": "Registry monitoring, task scheduler logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1078",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Escalated privileges using stolen credentials",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Domain accounts, sensitive systems" },
                            { "name": "IOCs", "value": "Anomalous privilege escalation attempts" },
                            { "name": "Parameters", "value": "Authentication logs, privilege monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1082",
                        "tactic": "discovery",
                        "color": "#ffcc99",
                        "comment": "Network and system discovery to locate SecurID data",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Network infrastructure, file servers" },
                            { "name": "IOCs", "value": "Net view, systeminfo, and whoami executions" },
                            { "name": "Parameters", "value": "Command line audits, network flow data" }
                        ]
                    },
                    {
                        "techniqueID": "T1570",
                        "tactic": "lateral-movement",
                        "color": "#ffcc99",
                        "comment": "Lateral movement to access staging servers and sensitive systems",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Domain-joined systems, file servers" },
                            { "name": "IOCs", "value": "Anomalous SMB/RDP connections from internal IPs" },
                            { "name": "Parameters", "value": "SMB logs, RDP session records" }
                        ]
                    },
                    {
                        "techniqueID": "T1005",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Collected SecurID seed values and related data",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "SecurID databases, file servers" },
                            { "name": "IOCs", "value": "Unauthorized access to SecurID data" },
                            { "name": "Parameters", "value": "File access logs, DLP monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.001",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "C2 via HTTPS to manage compromised systems",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Compromised hosts" },
                            { "name": "IOCs", "value": "HTTPS beacons to C2 domains" },
                            { "name": "Parameters", "value": "Proxy logs, DNS queries" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated SecurID data to external servers via FTP",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "File servers, staging servers" },
                            { "name": "IOCs", "value": "FTP transfers of password-protected RAR files" },
                            { "name": "Parameters", "value": "Network egress filtering, FTP logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1496",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Resource hijacking by using stolen SecurID data to target defense contractors",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Defense contractor networks" },
                            { "name": "IOCs", "value": "Unauthorized access attempts using SecurID tokens" },
                            { "name": "Parameters", "value": "Authentication logs, network monitoring" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "RSA SecurID (2011)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "privilege-escalation",
                    "credential-access", "discovery", "lateral-movement", "collection",
                    "command-and-control", "exfiltration", "defense-evasion", "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                // Custom manual edges to ensure full connectivity
                const initialAccessNode = mitreData.techniques.findIndex(t => t.tactic === "initial-access") + 1;
                const executionNode = mitreData.techniques.findIndex(t => t.tactic === "execution") + 1;
                const persistenceNode = mitreData.techniques.findIndex(t => t.tactic === "persistence") + 1;
                const privilegeEscalationNode = mitreData.techniques.findIndex(t => t.tactic === "privilege-escalation") + 1;
                const discoveryNode = mitreData.techniques.findIndex(t => t.tactic === "discovery") + 1;
                const lateralMovementNode = mitreData.techniques.findIndex(t => t.tactic === "lateral-movement") + 1;
                const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;
                const commandAndControlNode = mitreData.techniques.findIndex(t => t.tactic === "command-and-control") + 1;
                const exfiltrationNode = mitreData.techniques.findIndex(t => t.tactic === "exfiltration") + 1;
                const impactNode = mitreData.techniques.findIndex(t => t.tactic === "impact") + 1;

                // Initial Access → Execution
                if (initialAccessNode > 0 && executionNode > 0) {
                    edges.push({ from: initialAccessNode, to: executionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Execution → Persistence
                if (executionNode > 0 && persistenceNode > 0) {
                    edges.push({ from: executionNode, to: persistenceNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Persistence → Privilege Escalation
                if (persistenceNode > 0 && privilegeEscalationNode > 0) {
                    edges.push({ from: persistenceNode, to: privilegeEscalationNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Privilege Escalation → Discovery
                if (privilegeEscalationNode > 0 && discoveryNode > 0) {
                    edges.push({ from: privilegeEscalationNode, to: discoveryNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Discovery → Lateral Movement
                if (discoveryNode > 0 && lateralMovementNode > 0) {
                    edges.push({ from: discoveryNode, to: lateralMovementNode, arrows: "to", color: { color: "red" }, dashes: true });
                }

                // Lateral Movement → Collection
                if (lateralMovementNode > 0 && collectionNode > 0) {
                    edges.push({ from: lateralMovementNode, to: collectionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Collection → Command and Control
                if (collectionNode > 0 && commandAndControlNode > 0) {
                    edges.push({ from: collectionNode, to: commandAndControlNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Command and Control → Exfiltration
                if (commandAndControlNode > 0 && exfiltrationNode > 0) {
                    edges.push({ from: commandAndControlNode, to: exfiltrationNode, arrows: "to", color: { color: "green" }, width: 2 });
                }

                // Exfiltration → Impact
                if (exfiltrationNode > 0 && impactNode > 0) {
                    edges.push({ from: exfiltrationNode, to: impactNode, arrows: "to", color: { color: "purple" }, width: 2 });
                }

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
                    physics: { enabled: true },
                    nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
                    edges: { arrows: 'to', smooth: false },
                    interaction: { dragNodes: true, dragView: true, zoomView: true }
                };
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                network.fit();

                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
                    <a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">RSA SecurID (2011) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
                            <br/><strong>Background:</strong><br/>
                            <p>The RSA SecurID cyberattack, disclosed on March 17, 2011, was an advanced persistent threat (APT) attributed to a Chinese state-sponsored group (suspected PLA Unit 61398). Targeting RSA, a cybersecurity firm, the attack began with spearphishing emails exploiting a zero-day Adobe Flash vulnerability in an Excel attachment ("2011 Recruitment Plan.xls"), installing Poison Ivy malware. Attackers moved laterally, escalated privileges, and exfiltrated SecurID seed values, later used in attempted attacks on defense contractors like Lockheed Martin. RSA replaced nearly 40 million tokens, costing EMC $66.3 million, and the breach highlighted supply chain vulnerabilities in two-factor authentication systems.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>