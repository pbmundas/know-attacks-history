<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>British Airways Breach (2018) MITRE ATT&CK Navigator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.18.9/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis-network.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const attacksData = {
            "British Airways (2018)": {
                "name": "British Airways Breach (2018) MITRE ATT&CK Mapping",
                "versions": { "attack": "14", "navigator": "4.9.1", "layer": "4.5" },
                "domain": "enterprise-attack",
                "techniques": [
                    {
                        "techniqueID": "T1078.002",
                        "tactic": "initial-access",
                        "color": "#ff9999",
                        "comment": "Used compromised third-party (Swissport) credentials via Citrix Access Gateway without MFA to access British Airways’ network",
                        "enabled": true,
                        "metadata": [
                            { "name": "Vulnerability", "value": "Lack of MFA on third-party accounts" },
                            { "name": "Assets", "value": "Citrix Access Gateway, third-party accounts" },
                            { "name": "IOCs", "value": "Anomalous login attempts from Swissport credentials" },
                            { "name": "Threat Actors", "value": "Magecart (suspected)" },
                            { "name": "Parameters", "value": "Authentication logs, MFA enforcement" }
                        ]
                    },
                    {
                        "techniqueID": "T1059.007",
                        "tactic": "execution",
                        "color": "#ffcc99",
                        "comment": "Executed malicious JavaScript code on the British Airways website to skim customer data",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "British Airways website, Modernizr library" },
                            { "name": "IOCs", "value": "Malicious JavaScript code injection" },
                            { "name": "Parameters", "value": "Web server logs, file integrity monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1098",
                        "tactic": "persistence",
                        "color": "#ffcc99",
                        "comment": "Maintained access through the compromised third-party account in the Citrix environment",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Citrix environment, third-party accounts" },
                            { "name": "IOCs", "value": "Persistent unauthorized access" },
                            { "name": "Parameters", "value": "Session monitoring, account activity logs" }
                        ]
                    },
                    {
                        "techniqueID": "T1078.004",
                        "tactic": "privilege-escalation",
                        "color": "#ffcc99",
                        "comment": "Exploited an unsecured administrator password in plaintext to gain elevated access to the network",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Internal network, administrator accounts" },
                            { "name": "IOCs", "value": "Unauthorized admin access" },
                            { "name": "Parameters", "value": "Password storage audits, privilege escalation monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1027",
                        "tactic": "defense-evasion",
                        "color": "#ffcc99",
                        "comment": "Modified website code using an outdated Modernizr library to evade detection, blending with legitimate operations",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Website code, Modernizr library" },
                            { "name": "IOCs", "value": "Unauthorized code modifications" },
                            { "name": "Parameters", "value": "File integrity monitoring, behavioral analytics" }
                        ]
                    },
                    {
                        "techniqueID": "T1005",
                        "tactic": "collection",
                        "color": "#ffcc99",
                        "comment": "Collected customer data (names, emails, addresses, card details) via malicious JavaScript redirects to ‘baways.com’",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Customer data, payment forms" },
                            { "name": "IOCs", "value": "Redirects to fraudulent domain, data skimming" },
                            { "name": "Parameters", "value": "Web traffic logs, DLP monitoring" }
                        ]
                    },
                    {
                        "techniqueID": "T1071.001",
                        "tactic": "command-and-control",
                        "color": "#ffcc99",
                        "comment": "Established HTTPS-based C2 communication to manage the skimming operation",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Compromised website" },
                            { "name": "IOCs", "value": "HTTPS beacons to ‘baways.com’" },
                            { "name": "Parameters", "value": "Network traffic analysis, DNS queries" }
                        ]
                    },
                    {
                        "techniqueID": "T1041",
                        "tactic": "exfiltration",
                        "color": "#ffcc99",
                        "comment": "Exfiltrated stolen payment and personal data to attacker-controlled servers",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Customer data" },
                            { "name": "IOCs", "value": "Outbound data transfers to ‘baways.com’" },
                            { "name": "Parameters", "value": "Network egress filtering, DLP alerts" }
                        ]
                    },
                    {
                        "techniqueID": "T1490",
                        "tactic": "impact",
                        "color": "#ff6666",
                        "comment": "Disrupted operations by necessitating system remediation and customer notifications",
                        "enabled": true,
                        "metadata": [
                            { "name": "Assets", "value": "Website, customer accounts" },
                            { "name": "IOCs", "value": "System remediation activities" },
                            { "name": "Parameters", "value": "System change logs, notification records" }
                        ]
                    }
                ]
            }
        };

        const App = () => {
            const flowchartRef = React.useRef(null);
            const selectedAttack = "British Airways (2018)";
            const [selectedTechnique, setSelectedTechnique] = React.useState(null);

            React.useEffect(() => {
                const mitreData = attacksData[selectedAttack];
                const nodes = mitreData.techniques.map((tech, index) => ({
                    id: index + 1,
                    label: `${tech.techniqueID}: ${tech.tactic}`,
                    shape: "box",
                    color: tech.color
                }));

                const edges = [];
                const tacticOrder = [
                    "initial-access", "execution", "persistence", "privilege-escalation",
                    "defense-evasion", "collection", "command-and-control", "exfiltration",
                    "impact"
                ];

                const tacticNodes = {};
                mitreData.techniques.forEach((tech, index) => {
                    const nodeId = index + 1;
                    const tacticIndex = tacticOrder.indexOf(tech.tactic);
                    if (!tacticNodes[tech.tactic]) {
                        tacticNodes[tech.tactic] = [nodeId];
                    } else {
                        tacticNodes[tech.tactic].push(nodeId);
                    }
                    if (tacticIndex > 0) {
                        const prevTactic = tacticOrder[tacticIndex - 1];
                        if (tacticNodes[prevTactic]) {
                            tacticNodes[prevTactic].forEach(prevNodeId => {
                                edges.push({ from: prevNodeId, to: nodeId, arrows: "to" });
                            });
                        }
                    }
                });

                // Custom manual edges to ensure full connectivity
                const initialAccessNode = mitreData.techniques.findIndex(t => t.tactic === "initial-access") + 1;
                const executionNode = mitreData.techniques.findIndex(t => t.tactic === "execution") + 1;
                const persistenceNode = mitreData.techniques.findIndex(t => t.tactic === "persistence") + 1;
                const privilegeEscalationNode = mitreData.techniques.findIndex(t => t.tactic === "privilege-escalation") + 1;
                const defenseEvasionNode = mitreData.techniques.findIndex(t => t.tactic === "defense-evasion") + 1;
                const collectionNode = mitreData.techniques.findIndex(t => t.tactic === "collection") + 1;
                const commandAndControlNode = mitreData.techniques.findIndex(t => t.tactic === "command-and-control") + 1;
                const exfiltrationNode = mitreData.techniques.findIndex(t => t.tactic === "exfiltration") + 1;
                const impactNode = mitreData.techniques.findIndex(t => t.tactic === "impact") + 1;

                // Initial Access → Execution
                if (initialAccessNode > 0 && executionNode > 0) {
                    edges.push({ from: initialAccessNode, to: executionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Execution → Persistence
                if (executionNode > 0 && persistenceNode > 0) {
                    edges.push({ from: executionNode, to: persistenceNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Persistence → Privilege Escalation
                if (persistenceNode > 0 && privilegeEscalationNode > 0) {
                    edges.push({ from: persistenceNode, to: privilegeEscalationNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Privilege Escalation → Defense Evasion
                if (privilegeEscalationNode > 0 && defenseEvasionNode > 0) {
                    edges.push({ from: privilegeEscalationNode, to: defenseEvasionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Defense Evasion → Collection
                if (defenseEvasionNode > 0 && collectionNode > 0) {
                    edges.push({ from: defenseEvasionNode, to: collectionNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Collection → Command and Control
                if (collectionNode > 0 && commandAndControlNode > 0) {
                    edges.push({ from: collectionNode, to: commandAndControlNode, arrows: "to", color: { color: "blue" }, width: 2 });
                }

                // Command and Control → Exfiltration
                if (commandAndControlNode > 0 && exfiltrationNode > 0) {
                    edges.push({ from: commandAndControlNode, to: exfiltrationNode, arrows: "to", color: { color: "green" }, width: 2 });
                }

                // Exfiltration → Impact
                if (exfiltrationNode > 0 && impactNode > 0) {
                    edges.push({ from: exfiltrationNode, to: impactNode, arrows: "to", color: { color: "purple" }, width: 2 });
                }

                const container = flowchartRef.current;
                const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
                const options = {
                    physics: { enabled: true },
                    nodes: { font: { size: 12 }, shape: 'box', shapeProperties: { borderRadius: 5 } },
                    edges: { arrows: 'to', smooth: false },
                    interaction: { dragNodes: true, dragView: true, zoomView: true }
                };
                const network = new vis.Network(container, data, options);

                network.on("click", (params) => {
                    if (params.nodes.length > 0) {
                        const nodeId = params.nodes[0];
                        setSelectedTechnique(mitreData.techniques[nodeId - 1]);
                    }
                });

                network.fit();

                const handleResize = () => {
                    network.fit();
                };
                window.addEventListener('resize', handleResize);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    network.destroy();
                };
            }, []);

            return (
                <div className="container mx-auto p-4">
                    <a href="index.html" className="text-blue-600 hover:underline absolute top-4 right-4">Back to Index</a>
                    <h2 className="text-2xl font-bold mb-4">British Airways Breach (2018) MITRE ATT&CK Navigator</h2>
                    <div className="flex gap-4">
                        <div ref={flowchartRef} className="flex-[3] border border-gray-300 bg-white" style={{ height: '600px' }}></div>
                        <div className="flex-1 p-4 bg-gray-200 rounded-md overflow-y-auto" style={{ height: '600px' }}>
                            <h3 className="text-lg font-semibold">Technique Details</h3>
                            {selectedTechnique ? (
                                <pre className="whitespace-pre-wrap text-sm">
                                    <strong>Technique ID:</strong> {selectedTechnique.techniqueID}<br/>
                                    <strong>Tactic:</strong> {selectedTechnique.tactic}<br/>
                                    <strong>Comment:</strong> {selectedTechnique.comment}<br/>
                                    <strong>Metadata:</strong><br/>
                                    {selectedTechnique.metadata.map((meta, idx) => (
                                        <div key={idx}>
                                            <strong>{meta.name}:</strong> {meta.value}<br/>
                                        </div>
                                    ))}
                                </pre>
                            ) : (
                                <p>Click a node to view technique details, MITRE TTPs, IOCs, and technical information. Drag nodes to move them.</p>
                            )}
                            <br/><strong>Background:</strong><br/>
                            <p>The British Airways breach, disclosed on September 6, 2018, affected ~429,612 customers from August 21 to September 5, 2018. Attackers, likely Magecart, used compromised Swissport credentials via a Citrix Access Gateway without MFA to access the network. They escalated privileges with an unsecured plaintext administrator password and modified the website’s JavaScript, exploiting an outdated Modernizr library to redirect customer data to ‘baways.com.’ This skimmed names, emails, addresses, and card details for 244,000 customers, with partial data for 108,000 others. Undetected for over two months, a third-party alerted British Airways, who contained the breach within 90 minutes and notified the ICO and customers.</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
        <div class="mt-8 p-4 bg-white rounded-md shadow space-y-6">

  <!-- Attack Timeline -->
  <section>
        <h2 class="text-2xl font-semibold mb-4">Attack Timeline</h2>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Date/Time</th>
                        <th class="py-2 px-4 border-b">Action</th>
                        <th class="py-2 px-4 border-b">Actor/Details</th>
                        <th class="py-2 px-4 border-b">Evidence/Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Pre-June 22, 2018</td>
                        <td class="py-2 px-4 border-b">Preparation: Attackers compromise Swissport employee credentials, likely via phishing.</td>
                        <td class="py-2 px-4 border-b">Magecart (suspected)</td>
                        <td class="py-2 px-4 border-b">Access to Citrix Access Gateway; no MFA enabled.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">June 22, 2018</td>
                        <td class="py-2 px-4 border-b">Initial access: Attackers enter BA’s network using stolen Swissport credentials, escalate privileges with plaintext admin password.</td>
                        <td class="py-2 px-4 border-b">Magecart</td>
                        <td class="py-2 px-4 border-b">Access to BA’s internal systems; begin reconnaissance.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">August 21–September 5, 2018</td>
                        <td class="py-2 px-4 border-b">Data theft: Malicious JavaScript injected into BA’s payment page redirects data to baways.com.</td>
                        <td class="py-2 px-4 border-b">Magecart</td>
                        <td class="py-2 px-4 border-b">429,612 customers affected; 244,000 card details (including CVV), 77,000 names/addresses, 612 Executive Club accounts compromised.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">September 5, 2018</td>
                        <td class="py-2 px-4 border-b">Detection: Third-party security researcher alerts BA to malicious code.</td>
                        <td class="py-2 px-4 border-b">Security researcher</td>
                        <td class="py-2 px-4 border-b">BA removes code within 90 minutes; notifies ICO.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">September 6, 2018</td>
                        <td class="py-2 px-4 border-b">Response: BA informs 380,000 affected customers, advises contacting banks.</td>
                        <td class="py-2 px-4 border-b">BA</td>
                        <td class="py-2 px-4 border-b">No travel/passport data stolen; public apology issued.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 4, 2019</td>
                        <td class="py-2 px-4 border-b">ICO penalty notice: ICO proposes £183.39 million fine (1.5% of 2017 turnover) for GDPR violations.</td>
                        <td class="py-2 px-4 border-b">ICO</td>
                        <td class="py-2 px-4 border-b">Cites inadequate security (e.g., no MFA, no file integrity monitoring).</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">October 16, 2020</td>
                        <td class="py-2 px-4 border-b">Fine reduced: ICO finalizes £20 million fine, citing COVID-19 impact.</td>
                        <td class="py-2 px-4 border-b">ICO</td>
                        <td class="py-2 px-4 border-b">Largest ICO fine to date; BA cooperates fully.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">July 6, 2021</td>
                        <td class="py-2 px-4 border-b">Settlement: BA settles class-action lawsuit with affected customers/staff.</td>
                        <td class="py-2 px-4 border-b">BA/PGMBM law firm</td>
                        <td class="py-2 px-4 border-b">Confidential settlement; no admission of liability.</td>
                    </tr>
                    <tr>
                        <td class="py-2 px-4 border-b">August 21, 2025</td>
                        <td class="py-2 px-4 border-b">Ongoing legal action: Some customers sue BA for inadequate compensation.</td>
                        <td class="py-2 px-4 border-b">Law firm Your Lawyers</td>
                        <td class="py-2 px-4 border-b">Claims for distress, potential fraud; largest UK group-action data claim.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Dwell Time Analysis -->
        <h2 class="text-2xl font-semibold mb-4">Dwell Time Analysis</h2>
        <p class="mb-4">Dwell time was approximately 75 days (June 22 to September 5, 2018), from initial access to detection, due to undetected privilege escalation and lack of monitoring.</p>
        <div class="overflow-x-auto mb-8">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Step 1: Initial Access (Jun 22)</th>
                        <th class="py-2 px-4 border-b">Step 2: Collection/Spread (Aug 21–Sep 5)</th>
                        <th class="py-2 px-4 border-b">Step 3: Detection/Containment (Sep 5)</th>
                        <th class="py-2 px-4 border-b">Step 4: Recovery (Sep 6–2021)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b">Compromised Swissport credentials via Citrix. <br><strong>What went wrong</strong>: No MFA, plaintext admin password.</td>
                        <td class="py-2 px-4 border-b">JavaScript skims payment data to baways.com. <br><strong>Factor</strong>: No file integrity monitoring, no WAF.</td>
                        <td class="py-2 px-4 border-b">Third-party alert; code removed in 90 minutes. <br><strong>Factor</strong>: No internal SIEM/IDS; rapid response post-detection.</td>
                        <td class="py-2 px-4 border-b">Notified customers, settled lawsuits; enhanced security. <br><strong>Total time</strong>: £20M fine, millions in settlements.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p class="mb-4"><strong>Dwell Time Insight</strong>: The dwell time was prolonged (75 days vs. 2018 median ~78 days) due to no MFA, poor monitoring, and supply-chain trust. Detection relied on external notification, highlighting BA’s reactive stance. Rapid code removal mitigated further damage.</p>

        <!-- Learnings -->
        <h2 class="text-2xl font-semibold mb-4">Learnings</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="py-2 px-4 border-b">Root Cause Analysis</th>
                        <th class="py-2 px-4 border-b">Impact Assessment</th>
                        <th class="py-2 px-4 border-b">Detection Opportunities</th>
                        <th class="py-2 px-4 border-b">Response and Remediation</th>
                        <th class="py-2 px-4 border-b">Attribution Analysis</th>
                        <th class="py-2 px-4 border-b">Lessons Learned</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="py-2 px-4 border-b"><strong>Using 5 Whys</strong>: Why breached? Compromised Swissport credentials. Why compromised? No MFA. Why no MFA? Cost/security oversight. Why oversight? Prioritized operations. Why prioritized? Profit focus. <br> <strong>Other causes</strong>: Plaintext passwords, no file integrity monitoring. <br> <strong>Beginners</strong>: Root causes trace to weak authentication, vendor trust. <br> <strong>Experts</strong>: Fishbone factors: Process (no MFA policy), Technology (no WAF), Supply Chain (Swissport).</td>
                        <td class="py-2 px-4 border-b"><strong>Data</strong>: 429,612 customers’ data (244,000 cards, 77,000 names/addresses, 612 logins). <br> <strong>Financial</strong>: £20M fine, millions in settlements. <br> <strong>Reputational</strong>: Trust erosion, lawsuits. <br> <strong>Beginners</strong>: Impacts hit finances, reputation. <br> <strong>Experts</strong>: BIA metrics: RPO minimal, RTO days for code removal.</td>
                        <td class="py-2 px-4 border-b"><strong>Missed</strong>: JavaScript injection via WAF; privilege escalation via SIEM. <br> <strong>Opportunities</strong>: File integrity monitoring, MFA, supply-chain audits. <br> <strong>Failures</strong>: No IDS, no internal detection. <br> <strong>Beginners</strong>: Detection is like antivirus. <br> <strong>Experts</strong>: Sigma rule: <code>detection: logsource: category: web | selection: script_injection: magecart</code>.</td>
                        <td class="py-2 px-4 border-b"><strong>Immediate</strong>: Removed malicious code, notified customers. <br> <strong>Long-term</strong>: Added MFA, WAF, file monitoring; settled lawsuits. <br> <strong>Beginners</strong>: Response restores trust. <br> <strong>Experts</strong>: NIST IR followed: Identification (Sep 5), Containment (Sep 5), Eradication (Sep 6–).</td>
                        <td class="py-2 px-4 border-b"><strong>Suspected</strong>: Magecart group. <br> <strong>TTPs</strong>: JavaScript skimming, supply-chain attack align with Magecart. <br> <strong>Beginners</strong>: Attribution identifies hackers. <br> <strong>Experts</strong>: IOCs include baways.com, malicious script hashes.</td>
                        <td class="py-2 px-4 border-b">Implement MFA. <br> Deploy WAF, SIEM, DLP. <br> Audit supply chain. <br> Prioritize security monitoring. <br> <strong>Beginners</strong>: Secure logins, verify vendors. <br> <strong>Experts</strong>: Adopt MITRE ATT&CK, zero-trust architecture.</td>
                    </tr>
                </tbody>
            </table>
        </div>
</body>
</html>
